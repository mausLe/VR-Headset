A51 MACRO ASSEMBLER  VRHEADSET                                                            06/01/2019 03:28:46 PAGE     1


MACRO ASSEMBLER A51 V8.2.7.0
OBJECT MODULE PLACED IN .\Objects\vrheadset.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE vrheadset.a51 SET(SMALL) DEBUG PRINT(.\Listings\vrheadset.lst) OBJECT(.
                      \Objects\vrheadset.obj) EP

LOC  OBJ            LINE     SOURCE

                       1     
                       2     
                       3     
                       4     
                       5     
                       6     
                       7     
0000                   8     org   0000h
0000 802E              9     jmp   main
                      10     
0023                  11     org 0023h ;jump here when interrupt 8051 receives data (RI=1)
0023 020042           12     ljmp serial
                      13     
                      14     ;====================================================================
                      15     ; CODE SEGMENT
                      16     ;====================================================================
                      17     
0030                  18           org   0030h
0030                  19     main:   
0030 758921           20                     MOV TMOD, #00100001b
                      21                     ;timer0,mode1, 0-65535 for control servo
                      22                     ;timer1,mode2 0-255 auto reload for uart
0033 758DF3           23                     mov TH1,#0f3h ;baud rate 2400 with smod=0 and F_thachanh=12 Mhz //#0f3h
0036 759850           24                     mov SCON,#50h ;usually like this value
0039 75A890           25                     mov IE,#10010000b ;enable serial interrupt and disable other interrupts
003C D28E             26                     setb TR1 ;enable timer1 of uart
003E 80FE             27                     here: sjmp here ;loop here waiting for uart transmit to
0040 80EE             28                     JMP MAIN      
                      29                     
0042                  30     serial:
0042 AF99             31                     mov R7,SBUF
                      32                     ;mov R7,A
0044 1149             33                     acall control_servo
0046 C298             34                     clr RI
0048 32               35                     reti
                      36     
0049                  37     control_servo:
0049 BF6103           38                     cjne R7,#'a',pass1 ;if R7 != a then jump to pass1
004C 116F             39                     acall MOVE90 ;function for servo1
                      40                     ;acall Goc_45 ;function for servo2
004E 22               41                     ret ;return to serial function
                      42                     
004F BF6203           43     pass1:  cjne R7,#'b',pass2 ;if R7 != b then jump to pass2
0052 11AB             44                     acall MOVET90
0054 22               45                     ret
                      46                     
0055 BF5A00           47     pass2:  cjne R7,#90,pass3
                      48                     ;acall Goc_90
0058 22               49     pass3:  ret
                      50     
                      51     
                      52     ;------
                      53     
                      54                     
                      55                     
                      56                     
                      57                     
A51 MACRO ASSEMBLER  VRHEADSET                                                            06/01/2019 03:28:46 PAGE     2

                      58                     
                      59                     
                      60                     
                      61                     
                      62                     
                      63                     
                      64           
                      65     ;-----
                      66     
0059                  67     DELAYSV:
0059 7F05             68             MOV     R7,#5
005B                  69             DELAYSVV:
005B 758AA0           70             MOV TL0,#LOW(-60000)
005E 758C15           71             MOV TH0,#HIGH(-60000)
0061 D28C             72             SETB    TR0
0063 308DFD           73             AGAIN:  JNB     TF0,    AGAIN
0066 C28C             74             CLR     TR0
0068 C28D             75             CLR     TF0
006A DFEF             76             DJNZ R7,DELAYSVV
006C 7F00             77             MOV     R7,#0
006E 22               78             RET
                      79     ;------------------------------ CHUONG TRINH CON GOC SERVO -------------------
006F                  80     MOVE90:
006F 7F14             81             MOV R7,#20
0071                  82     MOVE900:
0071 D2A0             83             SETB P2.0
0073 11BA             84             CALL DELAY90
0075 C2A0             85             CLR P2.0
0077 11BA             86             CALL DELAY90
0079 DFF6             87             DJNZ R7,MOVE900
007B 7F00             88             MOV R7,#0
007D 22               89             RET
                      90     
007E                  91     MOVE45:
007E 7F14             92             MOV R7,#20
0080                  93     MOVE455:
0080 D2A0             94             SETB P2.0
0082 11CA             95             CALL DELAY45
0084 C2A0             96             CLR P2.0
0086 11CA             97             CALL DELAY45
0088 DFF6             98             DJNZ R7,MOVE455
008A 7F00             99             MOV R7,#0
008C 22              100             RET
                     101     
008D                 102     MOVE0:
008D 7F14            103             MOV R7,#20
008F                 104     MOVE00:
008F D2A0            105             SETB P2.0
0091 11DA            106             CALL DELAY0
0093 C2A0            107             CLR P2.0
0095 11DA            108             CALL DELAY0
0097 DFF6            109             DJNZ R7,MOVE00
0099 7F00            110             MOV R7,#0
009B 22              111             RET
                     112     
009C                 113     MOVET45:
009C 7F14            114             MOV R7,#20
009E                 115     MOVET455:
009E D2A0            116             SETB P2.0
00A0 11EA            117             CALL DELAYT45
00A2 C2A0            118             CLR P2.0
00A4 11EA            119             CALL DELAYT45
00A6 DFF6            120             DJNZ R7,MOVET455
00A8 7F00            121             MOV R7,#0
00AA 22              122             RET
00AB                 123     MOVET90:
A51 MACRO ASSEMBLER  VRHEADSET                                                            06/01/2019 03:28:46 PAGE     3

00AB 7F14            124             MOV R7,#20
00AD                 125     MOVET900:
00AD D2A0            126             SETB P2.0
00AF 11FA            127             CALL DELAYT90
00B1 C2A0            128             CLR P2.0
00B3 11FA            129             CALL DELAYT90
00B5 DFF6            130             DJNZ R7,MOVET900
00B7 7F00            131             MOV R7,#0
00B9 22              132             RET
                     133                     
00BA                 134     DELAY90:
00BA 758A3C          135             MOV TL0,#LOW(-2500)
00BD 758CF6          136             MOV TH0,#HIGH(-2500)
00C0 D28C            137             SETB TR0
00C2 308DFD          138             JNB  TF0,$
00C5 C28C            139             CLR  TR0
00C7 C28D            140             CLR  TF0
00C9 22              141             RET
00CA                 142     DELAY45:
00CA 758A30          143             MOV TL0,#LOW(-2000)
00CD 758CF8          144             MOV TH0,#HIGH(-2000)
00D0 D28C            145             SETB TR0
00D2 308DFD          146             JNB  TF0,$
00D5 C28C            147             CLR  TR0
00D7 C28D            148             CLR  TF0
00D9 22              149             RET
00DA                 150     DELAY0:
00DA 758A24          151             MOV TL0,#LOW(-1500)
00DD 758CFA          152             MOV TH0,#HIGH(-1500)
00E0 D28C            153             SETB TR0
00E2 308DFD          154             JNB  TF0,$
00E5 C28C            155             CLR  TR0
00E7 C28D            156             CLR  TF0
00E9 22              157             RET
00EA                 158     DELAYT45:
00EA 758A18          159             MOV TL0,#LOW(-1000)
00ED 758CFC          160             MOV TH0,#HIGH(-1000)
00F0 D28C            161             SETB TR0
00F2 308DFD          162             JNB  TF0,$
00F5 C28C            163             CLR  TR0
00F7 C28D            164             CLR  TF0
00F9 22              165             RET     
00FA                 166     DELAYT90:
00FA 758A0C          167             MOV TL0,#LOW(-500)
00FD 758CFE          168             MOV TH0,#HIGH(-500)
0100 D28C            169             SETB TR0
0102 308DFD          170             JNB  TF0,$
0105 C28C            171             CLR  TR0
0107 C28D            172             CLR  TF0
0109 22              173             RET
                     174     end
A51 MACRO ASSEMBLER  VRHEADSET                                                            06/01/2019 03:28:46 PAGE     4

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

AGAIN. . . . . . .  C ADDR   0063H   A   
CONTROL_SERVO. . .  C ADDR   0049H   A   
DELAY0 . . . . . .  C ADDR   00DAH   A   
DELAY45. . . . . .  C ADDR   00CAH   A   
DELAY90. . . . . .  C ADDR   00BAH   A   
DELAYSV. . . . . .  C ADDR   0059H   A   
DELAYSVV . . . . .  C ADDR   005BH   A   
DELAYT45 . . . . .  C ADDR   00EAH   A   
DELAYT90 . . . . .  C ADDR   00FAH   A   
HERE . . . . . . .  C ADDR   003EH   A   
IE . . . . . . . .  D ADDR   00A8H   A   
MAIN . . . . . . .  C ADDR   0030H   A   
MOVE0. . . . . . .  C ADDR   008DH   A   
MOVE00 . . . . . .  C ADDR   008FH   A   
MOVE45 . . . . . .  C ADDR   007EH   A   
MOVE455. . . . . .  C ADDR   0080H   A   
MOVE90 . . . . . .  C ADDR   006FH   A   
MOVE900. . . . . .  C ADDR   0071H   A   
MOVET45. . . . . .  C ADDR   009CH   A   
MOVET455 . . . . .  C ADDR   009EH   A   
MOVET90. . . . . .  C ADDR   00ABH   A   
MOVET900 . . . . .  C ADDR   00ADH   A   
P2 . . . . . . . .  D ADDR   00A0H   A   
PASS1. . . . . . .  C ADDR   004FH   A   
PASS2. . . . . . .  C ADDR   0055H   A   
PASS3. . . . . . .  C ADDR   0058H   A   
RI . . . . . . . .  B ADDR   0098H.0 A   
SBUF . . . . . . .  D ADDR   0099H   A   
SCON . . . . . . .  D ADDR   0098H   A   
SERIAL . . . . . .  C ADDR   0042H   A   
TF0. . . . . . . .  B ADDR   0088H.5 A   
TH0. . . . . . . .  D ADDR   008CH   A   
TH1. . . . . . . .  D ADDR   008DH   A   
TL0. . . . . . . .  D ADDR   008AH   A   
TMOD . . . . . . .  D ADDR   0089H   A   
TR0. . . . . . . .  B ADDR   0088H.4 A   
TR1. . . . . . . .  B ADDR   0088H.6 A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
